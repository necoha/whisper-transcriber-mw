# ğŸ¤ Whisper Transcriber - Full-Stack Speech-to-Text Suite

é«˜ç²¾åº¦ãªéŸ³å£°æ–‡å­—èµ·ã“ã—ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆMLX Whisperå¯¾å¿œï¼‰

Cross-platform speech-to-text application with **SRT/WebVTT subtitle export**, **dynamic model switching**, **DirectML GPU support**, **streaming processing** and **real-time progress tracking**.

## âœ¨ Features

- **ğŸ™ï¸ éŸ³å£°æ–‡å­—èµ·ã“ã—**: ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ + ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŒ²éŸ³
- **ğŸ¬ å­—å¹•å‡ºåŠ›**: SRT, WebVTT, ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ããƒ†ã‚­ã‚¹ãƒˆå½¢å¼
- **âš¡ GPUåŠ é€Ÿ**: macOS(MLX) / Windows(CUDA) / DirectML(AMD/Intel) è‡ªå‹•é¸æŠ
- **ğŸ”„ ãƒ¢ãƒ‡ãƒ«åˆ‡æ›¿**: Large-v3 â‡” Large-v3-Turbo ã‚’å‹•çš„ã«åˆ‡æ›¿
- **ğŸ® GPUæ¤œå‡º**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  GPU æƒ…å ±è¡¨ç¤ºã¨æœ€é©ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æ¨å¥¨
- **ğŸ“º ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡¦ç†**: é•·æ™‚é–“éŸ³å£°ã®åˆ†å‰²å‡¦ç†ï¼‹ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€²æ—è¡¨ç¤º
- **ğŸ“± ãƒ¢ãƒ€ãƒ³UI**: Electron + FastAPI ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆï¼ˆ3ã‚¹ãƒ†ãƒƒãƒ—ï¼‰

### 1. ä¾å­˜é–¢ä¿‚ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

**macOS:**
```bash
bash scripts/setup_venv_mac.sh
```

**Windows (NVIDIA GPU):**
```powershell
./scripts/setup_venv_win.ps1
```

**Windows (AMD/Intel GPU - DirectML):**
```powershell
./scripts/setup_venv_win_directml.ps1
```

### 2. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•

```bash
cd electron
npm i
npm run dev
```

### 3. ãƒ†ã‚¹ãƒˆ

1. **æ¥ç¶šç¢ºèª** ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ `{"status": "ok"}` ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°OK
2. **ğŸ® GPUæƒ…å ±** ãƒœã‚¿ãƒ³ã§ç¾åœ¨ã®GPUæ§‹æˆã‚’ç¢ºèª
   - ğŸŸ¢ NVIDIA GPU: CUDAæ¨å¥¨
   - ğŸ”´ AMD GPU: DirectMLæ¨å¥¨  
   - ğŸ”µ Intel GPU: DirectMLæ¨å¥¨
   - ğŸ Apple Silicon: MLXæ¨å¥¨
3. **ãƒ¢ãƒ‡ãƒ«é¸æŠ**: ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‹ã‚‰å¸Œæœ›ã®ãƒ¢ãƒ‡ãƒ«ã‚’é¸æŠ
   - ğŸ¯ **Large-v3 (é«˜ç²¾åº¦)**: ç²¾åº¦é‡è¦–
   - ğŸš€ **Large-v3-Turbo (é«˜é€Ÿ)**: é€Ÿåº¦é‡è¦–
   - âš–ï¸ **Medium (ãƒãƒ©ãƒ³ã‚¹)**: ä¸­ç¨‹åº¦
   - âš¡ **Base (è»½é‡)**: è»½é‡ãƒ»é«˜é€Ÿ
4. **ãƒ¢ãƒ‡ãƒ«åˆ‡æ›¿** ãƒœã‚¿ãƒ³ã§å³åº§ã«å¤‰æ›´å¯èƒ½
5. éŸ³å£°/å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
6. **å‡ºåŠ›å½¢å¼ã‚’é¸æŠ**:
   - ğŸ“„ **ãƒ†ã‚­ã‚¹ãƒˆ**: æ™®é€šã®æ–‡å­—èµ·ã“ã—
   - ğŸ¬ **SRTå­—å¹•**: æ˜ åƒç·¨é›†ã‚½ãƒ•ãƒˆç”¨å­—å¹•ãƒ•ã‚¡ã‚¤ãƒ«
   - ğŸŒ **WebVTT**: ã‚¦ã‚§ãƒ–å‹•ç”»ç”¨å­—å¹•ãƒ•ã‚¡ã‚¤ãƒ«
   - â±ï¸ **ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ããƒ†ã‚­ã‚¹ãƒˆ**: æ™‚åˆ»æƒ…å ±ä»˜ããƒ†ã‚­ã‚¹ãƒˆ
7. **é€ä¿¡**ã‚’ã‚¯ãƒªãƒƒã‚¯
8. å­—å¹•å½¢å¼ã®å ´åˆã€è‡ªå‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒé–‹å§‹ã•ã‚Œã¾ã™

### ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡¦ç†ï¼ˆé•·æ™‚é–“éŸ³å£°ï¼‰
1. **ğŸ“º ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°æ–‡å­—èµ·ã“ã—**ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ
2. **ãƒãƒ£ãƒ³ã‚¯è¨­å®š**:
   - ãƒãƒ£ãƒ³ã‚¯é•·: 30ç§’ï¼ˆæ¨å¥¨ï¼‰
   - é‡è¤‡æ™‚é–“: 3ç§’ï¼ˆæ¨å¥¨ï¼‰
3. **ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡¦ç†é–‹å§‹**ã‚’ã‚¯ãƒªãƒƒã‚¯
4. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€²æ—**:
   - ğŸ”„ éŸ³å£°åˆ†å‰² â†’ ğŸ“ ãƒãƒ£ãƒ³ã‚¯å‡¦ç† â†’ âœ… å®Œäº†
   - å‡¦ç†ä¸­ã‚‚éƒ¨åˆ†çµæœã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º
5. **âŒ ã‚­ãƒ£ãƒ³ã‚»ãƒ«**ã§å‡¦ç†ä¸­æ–­å¯èƒ½

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
whisper-transcriber/
â”œâ”€ electron/                   # Electron ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
â”‚  â”œâ”€ src/renderer/index.html  # SRTå‡ºåŠ›UIä»˜ããƒ¡ã‚¤ãƒ³ç”»é¢
â”‚  â””â”€ src/renderer/renderer.js # å­—å¹•ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé¸æŠãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€ backend/                    # FastAPI ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
â”‚  â”œâ”€ server.py               # /transcribe ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ (formatå¯¾å¿œ)
â”‚  â”œâ”€ engine.py               # MLX/faster-whisper æŠ½è±¡åŒ– (segmentså¯¾å¿œ)
â”‚  â””â”€ subtitles.py            # SRT/VTT/TXT ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆç”Ÿæˆ
â””â”€ scripts/                    # ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```

## ğŸ”§ è©³ç´°æ©Ÿèƒ½

### å­—å¹•ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

| å½¢å¼ | èª¬æ˜ | ç”¨é€” |
|------|------|------|
| **SRT** | `1\n00:00:00,000 --> 00:00:05,000\nãƒ†ã‚­ã‚¹ãƒˆ\n` | å‹•ç”»ç·¨é›†ã‚½ãƒ•ãƒˆ (Premiere, DaVinci) |
| **WebVTT** | `WEBVTT\n\n00:00:00.000 --> 00:00:05.000\nãƒ†ã‚­ã‚¹ãƒˆ` | ã‚¦ã‚§ãƒ–å‹•ç”» (HTML5 video) |
| **ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ããƒ†ã‚­ã‚¹ãƒˆ** | `[00:00:00,000 --> 00:00:05,000] ãƒ†ã‚­ã‚¹ãƒˆ` | ãƒ­ã‚°ãƒ»è¨˜éŒ²ç”¨ |

### API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

```bash
# å¥åº·ãƒã‚§ãƒƒã‚¯ + ãƒ¢ãƒ‡ãƒ«æƒ…å ±
GET http://127.0.0.1:8765/health
# ãƒ¬ã‚¹ãƒãƒ³ã‚¹: {"status", "backend", "current_model", "available_models"}

# æ–‡å­—èµ·ã“ã—ï¼ˆå­—å¹•å¯¾å¿œï¼‰
POST http://127.0.0.1:8765/transcribe
- file: éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«
- language: ja|en|auto (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)
- format: text|srt|vtt|txt (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: text)

# ãƒ¢ãƒ‡ãƒ«æƒ…å ±å–å¾—
GET http://127.0.0.1:8765/models
# ãƒ¬ã‚¹ãƒãƒ³ã‚¹: {"backend", "current_model", "available_models"}

# ãƒ¢ãƒ‡ãƒ«åˆ‡æ›¿
POST http://127.0.0.1:8765/models/switch
- model_name: large-v3|large-v3-turbo|medium|base

# GPUæƒ…å ±å–å¾—
GET http://127.0.0.1:8765/gpu
# ãƒ¬ã‚¹ãƒãƒ³ã‚¹: {"platform", "gpus", "recommended_backend", "directml_available", "cuda_available"}

# ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°æ–‡å­—èµ·ã“ã—é–‹å§‹
POST http://127.0.0.1:8765/transcribe/streaming
- file: éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«
- language: ja|en|auto (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)
- format: text|srt|vtt|txt (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: text)
- chunk_duration: ãƒãƒ£ãƒ³ã‚¯é•·ï¼ˆç§’ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 30ï¼‰
- overlap_duration: é‡è¤‡æ™‚é–“ï¼ˆç§’ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 3ï¼‰

# ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡¦ç†çŠ¶æ³å–å¾—
GET http://127.0.0.1:8765/transcribe/streaming/{job_id}
# ãƒ¬ã‚¹ãƒãƒ³ã‚¹: {"status", "progress", "current_chunk", "total_chunks", "full_text"}

# ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°çµæœå–å¾—
GET http://127.0.0.1:8765/transcribe/streaming/{job_id}/result?format=text
# ãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ or JSON

# ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡¦ç†ã‚­ãƒ£ãƒ³ã‚»ãƒ«
DELETE http://127.0.0.1:8765/transcribe/streaming/{job_id}

# ã‚µãƒãƒ¼ãƒˆå½¢å¼ä¸€è¦§
GET http://127.0.0.1:8765/formats
```

### ç’°å¢ƒå¤‰æ•°

```bash
ASR_BACKEND=auto|mlx|ctranslate2|directml  # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é¸æŠ
MODEL_ID=large-v3                          # ãƒ¢ãƒ‡ãƒ«æŒ‡å®š
ASR_LANG=ja                                # è¨€èªæŒ‡å®š
PORT=8765                                  # ãƒãƒ¼ãƒˆç•ªå·
```

## ğŸ› ï¸ æ‰‹å‹•ãƒ†ã‚¹ãƒˆ

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã¿èµ·å‹•

```bash
cd backend
source .venv/bin/activate  # Windows: .venv\Scripts\activate
python server.py
```

### cURLã§SRTå‡ºåŠ›ãƒ†ã‚¹ãƒˆ

```bash
curl -X POST http://127.0.0.1:8765/transcribe \
  -F "file=@sample.wav" \
  -F "format=srt" \
  -F "language=ja" \
  -o output.srt
```

## ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

| å•é¡Œ | è§£æ±ºæ–¹æ³• |
|------|----------|
| MLX import error | `requirements-mac.txt` ãŒvenvã«å…¥ã£ã¦ã„ã‚‹ã‹ç¢ºèª |
| CUDA not detected | NVIDIAãƒ‰ãƒ©ã‚¤ãƒæ›´æ–°ã€`COMPUTE_TYPE=int8_float16` è©¦è¡Œ |
| WebMå†ç”Ÿå¤±æ•— | FFmpegã‚’ã‚·ã‚¹ãƒ†ãƒ ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« |
| segments not available | ãƒ¢ãƒ‡ãƒ«ãŒ segments ã‚’è¿”ã™ã‹ç¢ºèª |

## ğŸ“¦ ãƒ“ãƒ«ãƒ‰

```bash
cd electron
npm run build
```

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®`.venv`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚‚`extraResources`ã§åŒæ¢±ã•ã‚Œã¾ã™ã€‚

---

## âœ… å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½

- âœ… **SRT/å­—å¹•å‡ºåŠ›**: è¤‡æ•°å­—å¹•å½¢å¼ã®è‡ªå‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- âœ… **Large-v3/Turboåˆ‡æ›¿UI**: ãƒ¢ãƒ‡ãƒ«é¸æŠãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ + å‹•çš„åˆ‡æ›¿
- âœ… **DirectMLå¯¾å¿œ**: AMD/Intel GPU ã‚µãƒãƒ¼ãƒˆ + GPUæƒ…å ±è¡¨ç¤º
- âœ… **ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡¦ç†**: é•·æ™‚é–“éŸ³å£°ã®åˆ†å‰²å‡¦ç† + ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€²æ—

## æ¬¡ã®å®Ÿè£…äºˆå®š

- ğŸ¨ **ãƒ†ãƒ¼ãƒåˆ‡æ›¿**: ãƒ€ãƒ¼ã‚¯/ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰
- ğŸ”Š **éŸ³å£°å“è³ªå‘ä¸Š**: VAD + ãƒã‚¤ã‚ºãƒªãƒ€ã‚¯ã‚·ãƒ§ãƒ³
- ğŸŒ **WebSocketæ¥ç¶š**: ã‚ˆã‚Šã‚¹ãƒ ãƒ¼ã‚ºãªãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡